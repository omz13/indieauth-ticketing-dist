<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>IndieAuth Ticketing DRAFT 0.1</title>
<meta content="David Somers" name="author">
<meta content='
       This document defines new protocols for use with IndieAuth(an extension
to OAuth 2.0) by defining how to request ("please push"), deposit
("push"), and grant ("exchange for a bearer token") tickets between two
parties. It further defines an new protocol to orchestrate the
aforementioned to allow a third-party to act on-behalf-of the first
party at the second-party. Use cases are provided. 
    ' name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="indieweb" name="keyword">
<meta content="indieauth" name="keyword">
<meta content="ticket" name="keyword">
<meta name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.10.2
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycairo 1.21.0
    pycountry 22.3.5
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 60.9.3
    six 1.16.0
    weasyprint 54.2
-->
<link href=".tmp.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left"></td>
<td class="center">Ticketing</td>
<td class="right">April 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Somers</td>
<td class="center">Experimental</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">indieweb.org</dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Somers</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">IndieAuth Ticketing DRAFT 0.1</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document defines new protocols for use with IndieAuth(an extension
to OAuth 2.0) by defining how to request ("please push"), deposit
("push"), and grant ("exchange for a bearer token") tickets between two
parties. It further defines an new protocol to orchestrate the
aforementioned to allow a third-party to act on-behalf-of the first
party at the second-party. Use cases are provided.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-use-cases" class="xref">Use Cases</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="xref">1.1.1</a>.  <a href="#name-there-is-a-feed-that-you-ca" class="xref">There is a feed that you can subscribe to</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="xref">1.1.2</a>.  <a href="#name-reading-private-content-on-" class="xref">Reading private content on-behalf-of</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1.2.3">
                    <p id="section-toc.1-1.1.2.1.2.3.1" class="keepWithNext"><a href="#section-1.1.3" class="xref">1.1.3</a>.  <a href="#name-reading-private-feeds" class="xref">Reading private feeds</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-conventions" class="xref">Conventions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.4">
                <p id="section-toc.1-1.1.2.4.1"><a href="#section-1.4" class="xref">1.4</a>.  <a href="#name-example-formatting" class="xref">Example Formatting</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-ticketing" class="xref">Ticketing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-who-implements-what" class="xref">Who implements what</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-an-archetypal-implementatio" class="xref">An archetypal implementation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-target-endpoint-discovery" class="xref">Target endpoint discovery</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="xref">2.3.1</a>.  <a href="#name-discover-subject-as-metadat" class="xref">Discover Subject AS Metadata</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="xref">2.3.2</a>.  <a href="#name-discover-audience-as-metada" class="xref">Discover Audience AS Metadata</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-request" class="xref">Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-processing" class="xref">Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-successful-response" class="xref">Successful Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="xref">2.7</a>.  <a href="#name-error-response" class="xref">Error Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a href="#section-2.8" class="xref">2.8</a>.  <a href="#name-the-ticket" class="xref">The Ticket</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.9">
                <p id="section-toc.1-1.2.2.9.1"><a href="#section-2.9" class="xref">2.9</a>.  <a href="#name-authorization-server-metada" class="xref">Authorization Server Metadata</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.10">
                <p id="section-toc.1-1.2.2.10.1"><a href="#section-2.10" class="xref">2.10</a>. <a href="#name-ticket-introspection" class="xref">Ticket Introspection</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-ticket-wanted-flow" class="xref">Ticket Wanted Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-target-endpoint-discovery-2" class="xref">Target Endpoint Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-request-2" class="xref">Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-processing-2" class="xref">Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-successful-response-2" class="xref">Successful Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-error-response-2" class="xref">Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-ticket-deposit-flow" class="xref">Ticket Deposit Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-target-discovery" class="xref">Target Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-request-3" class="xref">Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-processing-3" class="xref">Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-successful-response-3" class="xref">Successful Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-error-response-3" class="xref">Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-ticket-grant-flow" class="xref">Ticket Grant Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-discovery" class="xref">Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-request-4" class="xref">Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-processing-4" class="xref">Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-successful-response-4" class="xref">Successful Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-error-response-4" class="xref">Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-authorization-code-on-behal" class="xref">Authorization Code On-Behalf-Of Grant Flow</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-discovery-2" class="xref">Discovery</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-request-5" class="xref">Request</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-processing-5" class="xref">Processing</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-successful-response-5" class="xref">Successful Response</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-error-response-5" class="xref">Error Response</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-indieweb-considerations" class="xref">IndieWeb Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-oauth-parameters-registry" class="xref">"OAuth Parameters" Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-related-work" class="xref">Related Work</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-why-use-a-code-verifier" class="xref">Why use a Code Verifier?</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-document-history" class="xref">Document History</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-D" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document defines new protocols for use with <span>[<a href="#IndieAuth" class="xref">IndieAuth</a>]</span>
(an extension to OAuth 2.0 <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>) by defining flows between
participants that directly or indirectly use tickets as an instrument to facilitate the following activities:<a href="#section-1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1-2">
        <dt id="section-1-2.1">want ticket</dt>
        <dd style="margin-left: 1.5em" id="section-1-2.2">Requesting that ticket to be sent to somebody's (the requestor's)
authorization server.<a href="#section-1-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-2.3">deposit ticket</dt>
        <dd style="margin-left: 1.5em" id="section-1-2.4">Depositing (pushing) a ticket to an authorization server.<a href="#section-1-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-2.5">exchange ticket for authorization code</dt>
        <dd style="margin-left: 1.5em" id="section-1-2.6">Taking a deposited ticket and exchanging it with its issuer for an
access code (Bearer token).<a href="#section-1-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-1-2.7">third-party wants an authorization code</dt>
        <dd style="margin-left: 1.5em" id="section-1-2.8">Choreography across three parties to provide an authorization code
(Bearer token) to a third-party to use at a second-party by
impersonating the first-party.<a href="#section-1-2.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-1-3">These activities are implemented respectively by the following flows:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-4.1">Ticket Wanted flow as specified in <a href="#ticket-wanted-flow" class="xref">Section 3</a>.<a href="#section-1-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.2">Ticket Deposit flow as specified in <a href="#ticket-deposit-flow" class="xref">Section 4</a>.<a href="#section-1-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.3">Ticket Grant flow as specified in <a href="#ticket-grant-flow" class="xref">Section 5</a>.<a href="#section-1-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-4.4">Authorization Code On-Behalf-Of grant flow as specified in
<a href="#code-obo-flow" class="xref">Section 6</a>.<a href="#section-1-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<div id="use-cases">
<section id="section-1.1">
        <h3 id="name-use-cases">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
        </h3>
<p id="section-1.1-1">The participants are:<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-2.1">The first-party, formally the subject, also known as Alice, who
authenticates herself to services using an IndieAuth authorization
server as specified in Section 5.3.2 of <span>[<a href="#IndieAuth" class="xref">IndieAuth</a>]</span>.<a href="#section-1.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.2">The second-party, formally the resource server, also known as Bob, is
a publisher who makes protected resources available to authorized
parties using IndieAuth for identification and Bearer Token Usage
<span>[<a href="#RFC6750" class="xref">RFC6750</a>]</span>.<a href="#section-1.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-2.3">The third-party, formally the actor, also known as Carol, who can
perform different roles for the benefit of the Alice (first-party) at
the Bob (the second-party) who in this context is formally the
audience(for Carol's performance).<a href="#section-1.1-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<div id="use-case-sub">
<section id="section-1.1.1">
          <h4 id="name-there-is-a-feed-that-you-ca">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-there-is-a-feed-that-you-ca" class="section-name selfRef">There is a feed that you can subscribe to</a>
          </h4>
<p id="section-1.1.1-1">In this case, Carol is playing the role of Felicity who is a feed
reader.<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1.1-2">Bob makes available feed-oriented resources which can be used by Alice
to read resources recently published on his site. Bob tells Alice's
authorization server the location of the feed, which then tells Felicity
to subscribe to it.<a href="#section-1.1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1.1-3">This to be achieved when:<a href="#section-1.1.1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1.1-4">
<li id="section-1.1.1-4.1">The resource server (Bob) implements ticket deposit flow.<a href="#section-1.1.1-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-1.1.1-4.2">The subject's (Alice) authorization server implements ticket
deposit flow and optionally ticket grant flow.<a href="#section-1.1.1-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-1.1.1-4.3">The resource server (Bob) uses ticket deposit flow to inform the
subject (Alice) that there is a feed she might want to subscribe to.
When Bob informs Alice of the location of the feed is at the
discretion of the resource server.<a href="#section-1.1.1-4.3" class="pilcrow">¶</a>
</li>
            <li id="section-1.1.1-4.4">If the subject's (Alice) authorization server implements ticket
grant flow it then performs it. This serves the important purpose of
confirming that the ticket originated from Bob (the resource server)
and not a nefarious actor. The secondary purpose is to have a Bearer
token that can be passed to a feed reader to access private
resources.<a href="#section-1.1.1-4.4" class="pilcrow">¶</a>
</li>
            <li id="section-1.1.1-4.5">The subject's (Alice) authorization server requests the reader (Felicity) to
subscribe to Bob's feed using an appropriate mechanism; how this is
achieved is dependent on the authorization server and the feed reader
but would typically involve a WebSub subscription request as
specified in Section 5.1 of <span>[<a href="#W3C.REC-websub-20180123" class="xref">W3C.REC-websub-20180123</a>]</span>.<a href="#section-1.1.1-4.5" class="pilcrow">¶</a>
</li>
          </ol>
<span id="name-use-case-of-ticketing-for-f"></span><figure id="figure-1">
            <div class="alignLeft art-ascii-art art-text artwork" id="section-1.1.1-5.1">
<pre>┌───────────────────────┐    ┌───────────────────────┐    ┌───────────┐
│        "Alice"        │    │         "Bob"         │    │"Felicity" │
├───────────────────────┤    ├───────────────────────┤    ├───────────┤
│        subject        │    │    resource server    │    │   actor   │
├───────────┬───────────┤    ├───────────┬───────────┤    ├───────────┤
│  profile  │subject as │    │ metadata  │audience as│    │ websubhub │
└───────────┴───────────┘    └───────────┴─────┬─────┘    └───────────┘
      │           │                │           │                │
      │           │                │discover   │                │
      │◀──────────┼────────────────┼─subject─ ┌┴┐               │
      │           │                │metadata  │D│               │
      │           │                │          │ │               │
      │          ┌┴┐◁───ticket─────┼──────────└┬┘               │
      │          │D│               │           │                │
      │          │ │   discover    │           │                │
      │          │┌┴┐──audience───▶│           │                │
      │          ││ │  metadate    │           │                │
      │          ││ │              │           │                │
      │          ││X│  ticket      │           │                │
      │          ││ │──grant───────┼─────────▷┌┴┐               │
      │          ││ │              │          │X│               │
      │          │└┬┘◀ ─ ac─ ─ ─ ─ ┼ ─ ─ ─ ─ ─└┬┘               │
      │          │ │               │           │     subscribe  │
      │          └┬┘───────────────┼───────────┼──────to feed──▶│
      ▼           ▼                ▼           ▼                ▼

D: ticket deposit flow
X: ticket grant flow (exchange ticket for token)
S: subscribe to feed
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-use-case-of-ticketing-for-f" class="selfRef">Use case of ticketing for feed notification and subscription</a>
            </figcaption></figure>
</section>
</div>
<div id="use_case_obo">
<section id="section-1.1.2">
          <h4 id="name-reading-private-content-on-">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-reading-private-content-on-" class="section-name selfRef">Reading private content on-behalf-of</a>
          </h4>
<p id="section-1.1.2-1">In this case, Carol is playing the role of Rachel, an impersonator, who
only does so with a permissive and in a non-malicious manner.<a href="#section-1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.1.2-2">Alice wants to have Rachel read private resources that Bob makes
available to her. Bob does not know Rachel but Rachel can impersonate
Alice so she can read things on-behalf-of Alice.<a href="#section-1.1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.1.2-3">To achieve this the goal is the acquisition of an authorization code
(Bearer token) across the security boundary of three parties
(subject, audience, and actor/impersonator).<a href="#section-1.1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.1.2-4">It should be stressed that this should happen without any action
needed by the subject (it is "hands-off"), who also retaining agency
over obtaining and passing token-based authorization codes to their
chosen actor and that no preexisting relationship is needed between
audience and actor.<a href="#section-1.1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.1.2-5">This to be achieved when:<a href="#section-1.1.2-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1.1.2-6">
<li id="section-1.1.2-6.1">The subject's authorization server implements ticket deposit flow,
token grant flow, and authorization code on-behalf-of grant flow.<a href="#section-1.1.2-6.1" class="pilcrow">¶</a>
</li>
            <li id="section-1.1.2-6.2">The audience's authorization server implements ticket wanted flow,
ticket deposit flow, and ticket grant flow.<a href="#section-1.1.2-6.2" class="pilcrow">¶</a>
</li>
            <li id="section-1.1.2-6.3">The actor implements authorization code on-behalf-of grant flow.<a href="#section-1.1.2-6.3" class="pilcrow">¶</a>
</li>
            <li id="section-1.1.2-6.4">The actor attempts to read a protected resource from the audience,
receives a 403 Unauthorized response, then performs authorization
code on-behalf-of grant flow with the subject's authorization server
to obtain a Bearer token that can be used to access the protected
resource.<a href="#section-1.1.2-6.4" class="pilcrow">¶</a>
</li>
          </ol>
<span id="name-use-case-of-ticketing-for-a"></span><figure id="figure-2">
            <div class="alignLeft art-ascii-art art-text artwork" id="section-1.1.2-7.1">
<pre>┌───────────────────────┐    ┌───────────────────────┐    ┌───────────┐
│        "Alice"        │    │         "Bob"         │    │ "Rachel"  │
├───────────────────────┤    ├───────────────────────┤    ├───────────┤
│        subject        │    │    resource server    │    │   actor   │
├───────────┬───────────┤    ├───────────┬───────────┤    ├───────────┤
│  profile  │subject as │    │ metadata  │audience as│    │  reader   │
└───────────┴───────────┘    └───────────┴───────────┘    └───────────┘
      │           │                │           │                │
      │           │                │           │     discover   │
      │◀──────────┼────────────────┼───────────┼──────subject──┌┴┐
      │           │                │           │     metadata  │O│
      │           │                │           │               │ │
      │          ┌┴┐◀──────────────┼───────────┼───────ac-obo──│ │
      │          │O│   discover    │           │               │ │
      │          │┌┴┐──audience───▶│           │               │ │
      │          ││W│  metadata    │           │               │ │
      │          ││ │              │           │               │ │
      │          ││ ├──want ticket─┼─────────▶┌┴┐              │ │
      │          ││ │              │          │W│              │ │
      │          │└┬┘◀─ ack ─ ─ ─ ─│─ ─ ─ ─ ─ │ │              │ │
      │          │ │               │          │ │              │ │
      │          │ │               │discover  │ │              │ │
      │◀─────────┤ ├───────────────┼─subject─┌┴┐│              │ │
      │          │ │               │metadata │D││              │ │
      │          │ │               │         │ ││              │ │
      │          │┌┴┐◁──ticket─────┼─────────└┬┘│              │ │
      │          ││D│              │          │ │              │ │
      │          │└┬┘  discover    │          │ │              │ │
      │          │┌┴┐──audience───▶│          │ │              │ │
      │          ││ │  metadate    │          │ │              │ │
      │          ││ │              │          │ │              │ │
      │          ││X│  ticket      │          │ │              │ │
      │          ││ │──grant───────┼────────▷┌┴┐│              │ │
      │          ││ │              │         │X││              │ │
      │          │└┬┘ ◀ ─ac ─ ─ ─ ─│─ ─ ─ ─ ─└┬┘│              │ │
      │          │ │               │          └┬┘              │ │
      │          └┬┘─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ac─ ▶└┬┘
      │           │                │           │                │
      ▼           ▼                ▼           ▼                ▼

W: want ticket flow
D: ticket deposit flow
X: ticket grant flow (exchange ticket for token)
O: code obo grant flow (get token via ticketing between participants)
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-use-case-of-ticketing-for-a" class="selfRef">Use case of ticketing for acquiring an authorization code for use by a third-party</a>
            </figcaption></figure>
</section>
</div>
<div id="reading-private-feeds">
<section id="section-1.1.3">
          <h4 id="name-reading-private-feeds">
<a href="#section-1.1.3" class="section-number selfRef">1.1.3. </a><a href="#name-reading-private-feeds" class="section-name selfRef">Reading private feeds</a>
          </h4>
<p id="section-1.1.3-1">In this case, Carol performs a dual role (she is Felicity-Rachel): the
ability to not only read feeds (the Felicity role), which themselves
may be a protect resource, but also any protected resources in the
feed, by impersonating Alice as necessary (the Rachel role).<a href="#section-1.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="conventions">
<section id="section-1.2">
        <h3 id="name-conventions">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-conventions" class="section-name selfRef">Conventions</a>
        </h3>
<p id="section-1.2-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-1.3">
        <h3 id="name-terminology">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.3-1">This specification uses
the terms "as metadata"
and "user profile URL"
defined by <span>[<a href="#IndieAuth" class="xref">IndieAuth</a>]</span>,
the terms
"access token",
"authorization server",
"authorization endpoint",
"authorization request",
"client",
"resource server", and
"token endpoint"
defined by The OAuth 2.0 Authorization Framework <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>,
the terms
"delegation" and
"security token service"
defined by <span>[<a href="#RFC8693" class="xref">RFC8693</a>]</span>
the term "bearer token"
defined by <span>[<a href="#RFC6750" class="xref">RFC6750</a>]</span><a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">This specification defines the following terms:<a href="#section-1.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-1.3-3">
          <dt id="section-1.3-3.1">Actor</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.2">A URL that represents the identity of the acting party. Typically,
this will be the party (the third-party) that is authorized to use a
token obtained by and to act on-behalf-of the subject at another
party (the second-party).<a href="#section-1.3-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.3">Audience</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.4">A URL that represents the second-party in a multi-participant
protocol.<a href="#section-1.3-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.5">Role</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.6">The activity (a scope) that an actor will perform on-behalf-of a
subject.<a href="#section-1.3-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.7">Subject</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.8">A person, the first-party in a multi-participant protocol.<a href="#section-1.3-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.9">Subject Identity</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.10">The identity of the subject as a URI, nominally an IndieAuth user
profile URL.<a href="#section-1.3-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.11">Ticket</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.12">A ticket is an opaque string, not intended to have any meaning to
clients using it.<a href="#section-1.3-3.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.13">Ticket Endpoint</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.14">The IndieAuth/OAuth 2.0 endpoint through which ticket deposit
operation is accomplished.<a href="#section-1.3-3.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.15">Ticket Wanted Endpoint</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.16">The IndieAuth/OAuth 2.0 endpoint through which ticket wanted operation
is accomplished.<a href="#section-1.3-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.3-3.17">Ticketing</dt>
          <dd style="margin-left: 1.5em" id="section-1.3-3.18">The act of acquiring or using tickets as a utility to allow
information to be exchanged between two or more parties through use
of the network protocol defined in this document.<a href="#section-1.3-3.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="example-formatting">
<section id="section-1.4">
        <h3 id="name-example-formatting">
<a href="#section-1.4" class="section-number selfRef">1.4. </a><a href="#name-example-formatting" class="section-name selfRef">Example Formatting</a>
        </h3>
<p id="section-1.4-1">Where examples of protocol messages are given, the payload has been
formatted for presentation and is not a true representation of what
is the wire data: for form-urlencoded payloads URL-encoding has not
been done and additional white-space and line-breaks are shown between
key-value pairs to aid readability; similarly for JSON payloads.<a href="#section-1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ticketing">
<section id="section-2">
      <h2 id="name-ticketing">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-ticketing" class="section-name selfRef">Ticketing</a>
      </h2>
<p id="section-2-1">This specification defines new protocol flows around the use of tickets
between participants in the IndieAuth universe:<a href="#section-2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2-2">
        <dt id="section-2-2.1">Ticket Wanted</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.2">This is where somebody requests an authorization server to send a
ticket to the authorization server for a subject.<a href="#section-2-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.3">Ticket Deposit</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.4">This is where somebody issues a ticket to the authorization server
for a subject to indicate that it can be exchanged at the
authorization server for the audience to obtain an access code
(Bearer token) or to notify them simply of the presence of a
feed at the resource server that they may be interested in subscribing to.<a href="#section-2-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.5">Ticket Grant</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.6">This is where a ticket is redeemed at the authorization server for
audience to grant a token assigned to the subject.<a href="#section-2-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-2-2.7">Authorization Code On-Behalf-Of (ac-obo) Grant</dt>
        <dd style="margin-left: 1.5em" id="section-2-2.8">This is where an actor requests that the authorization server for
the subject for a bearer token to use at the audience on their
behalf. The authorization server validates that the request is from
the actor and then orchestrates wanted ticket flow with the
audience, waits for it to send a ticket using ticket deposit flow,
then exchanges the ticket with the authorization server for the
audience for a token, and finally returns the token to the caller.<a href="#section-2-2.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<div id="who-implements-what">
<section id="section-2.1">
        <h3 id="name-who-implements-what">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-who-implements-what" class="section-name selfRef">Who implements what</a>
        </h3>
<p id="section-2.1-1">The following table summarizes which participant/system is responsible
for implementing which side of each ticketing flow.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">ticketing flow</th>
              <th class="text-left" rowspan="1" colspan="1">client</th>
              <th class="text-left" rowspan="1" colspan="1">server</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">(W) ticket wanted</td>
              <td class="text-left" rowspan="1" colspan="1">subject as</td>
              <td class="text-left" rowspan="1" colspan="1">audience as</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">(D) ticket deposit</td>
              <td class="text-left" rowspan="1" colspan="1">audience as</td>
              <td class="text-left" rowspan="1" colspan="1">subject as</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">(X) ticket grant</td>
              <td class="text-left" rowspan="1" colspan="1">subject as</td>
              <td class="text-left" rowspan="1" colspan="1">audience as</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">(O) ac-obo grant</td>
              <td class="text-left" rowspan="1" colspan="1">actor</td>
              <td class="text-left" rowspan="1" colspan="1">subject as</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="an-archetypal-implementation">
<section id="section-2.2">
        <h3 id="name-an-archetypal-implementatio">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-an-archetypal-implementatio" class="section-name selfRef">An archetypal implementation</a>
        </h3>
<p id="section-2.2-1">Each protocol flow follows an archetypal pattern, as illustrated in
<a href="#archey" class="xref">Figure 3</a>, between an initiator (the client-side of an HTTP request)
and a target (the sever-side of an HTTP response):<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.2-2">
          <dt id="section-2.2-2.1">Client: Discovery (of the target endpoint)</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2">The client discovers the target endpoint to where a request is to be
made under the doctrine of "distrust and verify" per
<a href="#security-considerations" class="xref">Section 7</a>.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">Client: Make the request</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.4">The client makes a request to the target endpoint as an HTTP "POST".<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">Server: Receive the request and work it</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.6">The endpoint receives the request, validates the parameters, ensures
that the request is valid, meets all policy and other criteria of
the authorization server, processes the request to build response
parameters, and returns the response.<a href="#section-2.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.7">Client: Receive the response and work it</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.8">The response is either a successful response or an error response.<a href="#section-2.2-2.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<span id="name-archetypal-flow"></span><div id="archey">
<figure id="figure-3">
          <div class="alignLeft art-ascii-art art-text artwork" id="section-2.2-3.1">
<pre>┌─────────────┐                     ┌─────────────┐
│  Initiator  │                     │   Target    │
├─────────────┤                     ├─────────────┤
│   Client    │                     │   Server    │
└─────────────┘                     └─────────────┘
       │                                   │
      ┌┴┐──┐                               │
      │ │  │ Discover                      │
      │ │  │ Target                        │
      │ │  │ Endpoint                      │
      │ │◀─┘                               │
      │ │    POST to target                │
      │ │────parameters are──────────────▶┌┴┐──┐validate parameters
      │ │    x-www-form-urlencoded        │ │  │meets criteria?
      │ │                                 │ │◀─┘meets policy?
      │ │                                 │ │
┌ALT─ ┤ ├ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┤ ├ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
      │ │                                 │ │──┐ work request          │
│     │ │◀ ─ ─ ─ ─ ─ Successful Response ─│ │◀─┘ build response
 ─ ─ ─│ │─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│ │─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┤
│     │ │                                 │ │
      │ │◀─ ─ ─ ─ ─ ─ ─ ─ Error Response─ ┤ │                          │
└ ─ ─ ┤ ├ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┴┬┴ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─
      │ │──┐                               │
      │ │◀─┘work response                  │
      └┬┘                                  │
       ▼                                   ▼
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-archetypal-flow" class="selfRef">Archetypal flow</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="disco">
<section id="section-2.3">
        <h3 id="name-target-endpoint-discovery">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-target-endpoint-discovery" class="section-name selfRef">Target endpoint discovery</a>
        </h3>
<p id="section-2.3-1">The client needs to discover the endpoint where the request needs to
be made.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<div id="disco-subject-as-metadata">
<section id="section-2.3.1">
          <h4 id="name-discover-subject-as-metadat">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-discover-subject-as-metadat" class="section-name selfRef">Discover Subject AS Metadata</a>
          </h4>
<p id="section-2.3.1-1">For "subject":<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">A subject is identified by a user profile URL which is their canonical
homepage in the world wide web at a domain which is unique to them
and accessible by either the http or https scheme as specified in
section 3.1 of <span>[<a href="#IndieAuth" class="xref">IndieAuth</a>]</span>.<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-2.3.1-3">It is RECOMMENDED that a profile URL with a http scheme be considered
unacceptable due to<a href="#security-considerations" class="xref">Section 7</a>.<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
<p id="section-2.3.1-4">The client undertakes discovery as specified in Section 4.1 of
<span>[<a href="#IndieAuth" class="xref">IndieAuth</a>]</span> against the user profile URL.<a href="#section-2.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="disco-audience-as-metadata">
<section id="section-2.3.2">
          <h4 id="name-discover-audience-as-metada">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-discover-audience-as-metada" class="section-name selfRef">Discover Audience AS Metadata</a>
          </h4>
<p id="section-2.3.2-1">For "audience":<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<p id="section-2.3.2-2">Do discovery for "audience" as detailed in Section 4.1 of <span>[<a href="#IndieAuth" class="xref">IndieAuth</a>]</span><a href="#section-2.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="flow-request">
<section id="section-2.4">
        <h3 id="name-request">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-request" class="section-name selfRef">Request</a>
        </h3>
<p id="section-2.4-1">The client makes a request to the target endpoint using the HTTP
"POST" method. Parameters are included in the HTTP request entity-body
 using the "application/x-www-form-urlencoded" format with a
 character encoding of UTF-8 as described in Appendix B of
 <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">The parameters are detailed for each flow in this specification.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flow-processing">
<section id="section-2.5">
        <h3 id="name-processing">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-processing" class="section-name selfRef">Processing</a>
        </h3>
<p id="section-2.5-1">When an server receives a request it performs the following steps:<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.5-2">
<li id="section-2.5-2.1">Validate the parameters to ensure that all mandatory one are present.<a href="#section-2.5-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.5-2.2">
            <p id="section-2.5-2.2.1">Ensure that the parameter values are semantically correct, for
example:<a href="#section-2.5-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.5-2.2.2.1">The type matches that expected.<a href="#section-2.5-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.5-2.2.2.2">If a URL is expected that the value can be parsed as a URL and is
normalized as required.<a href="#section-2.5-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-2.5-2.3">Ensures that it meets all policy and other criteria specific to
the implementation.<a href="#section-2.5-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.5-2.4">Works the request and construct the result parameters.<a href="#section-2.5-2.4" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="flow-successful-response">
<section id="section-2.6">
        <h3 id="name-successful-response">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-successful-response" class="section-name selfRef">Successful Response</a>
        </h3>
<p id="section-2.6-1">A successful response is constructed by adding the result parameters to
the entity-body of the HTTP response using the "application/json" media
type, as specified by <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span>, and an HTTP 202 status code or other
applicable code. The result parameters are serialized into a JavaScript
Object Notation (JSON) structure by adding each parameter at the top
level. Parameter names and string values are included as JSON strings.
Numerical values are included as JSON numbers. The order of parameters
does not matter and can vary.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">The result parameters are detailed for each flow in this specification.<a href="#section-2.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="flow-error-response">
<section id="section-2.7">
        <h3 id="name-error-response">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-error-response" class="section-name selfRef">Error Response</a>
        </h3>
<p id="section-2.7-1">If the request is not valid or is unacceptable based on policy or
there is a problem when processing the request the authorization
server MUST construct an error response, as specified in Section 5.2
of <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>. The value of the "error" parameter MUST be
the "invalid_request" error code or other values as detailed for each
flow in this specification.<a href="#section-2.7-1" class="pilcrow">¶</a></p>
<p id="section-2.7-2">The authorization server MAY include additional information regarding
the reasons for the error using the "error_description" as discussed
in Section 5.2 of <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-2.7-2" class="pilcrow">¶</a></p>
<p id="section-2.7-3">Other HTTP status codes may also be used as appropriate, for example:<a href="#section-2.7-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.7-4">
          <dt id="section-2.7-4.1">405</dt>
          <dd style="margin-left: 1.5em" id="section-2.7-4.2">If the request did not use the "POST" method, the authorization
server responds with an HTTP 405 (Method Not Allowed) status code.<a href="#section-2.7-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-4.3">413</dt>
          <dd style="margin-left: 1.5em" id="section-2.7-4.4">If the request size was beyond the upper bound that the
authorization server allows, the authorization server responds with
an HTTP 413 (Payload Too Large) status code.<a href="#section-2.7-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.7-4.5">429</dt>
          <dd style="margin-left: 1.5em" id="section-2.7-4.6">If the number of requests from a client during a particular time
period exceeds the number the authorization server allows, the
authorization server responds with an HTTP 429 (Too Many Requests)
status code.<a href="#section-2.7-4.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="the-ticket">
<section id="section-2.8">
        <h3 id="name-the-ticket">
<a href="#section-2.8" class="section-number selfRef">2.8. </a><a href="#name-the-ticket" class="section-name selfRef">The Ticket</a>
        </h3>
<p id="section-2.8-1">The ticket is an opaque string. It MUST be at lest 16 characters in
length and no more than 512 characters.<a href="#section-2.8-1" class="pilcrow">¶</a></p>
<p id="section-2.8-2">When an authorization server generates a ticket it is HIGHLY
RECOMMENDED that it is a version 4 UUID generated as specified in
Section 4.4 of <span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span>.<a href="#section-2.8-2" class="pilcrow">¶</a></p>
<p id="section-2.8-3">If an authorization server wants to generate a structured ticket it
MUST not be a JWT due to <a href="#security-considerations" class="xref">Section 7</a> and its content
MUST respect <a href="#privacy-considerations" class="xref">Section 8</a>.<a href="#section-2.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="as-metadata">
<section id="section-2.9">
        <h3 id="name-authorization-server-metada">
<a href="#section-2.9" class="section-number selfRef">2.9. </a><a href="#name-authorization-server-metada" class="section-name selfRef">Authorization Server Metadata</a>
        </h3>
<p id="section-2.9-1">The following authorization server metadata <span>[<a href="#RFC8414" class="xref">RFC8414</a>]</span> parameters are
introduced to signal an authorization server's capability and policy
with respect to which aspects of ticketing it supports.<a href="#section-2.9-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-2.9-2">
          <dt id="section-2.9-2.1">ticket_wanted_endpoint</dt>
          <dd style="margin-left: 1.5em" id="section-2.9-2.2">If this endpoint is declared this indicates that the authorization
server implements the server-side of ticket wanted flow.<a href="#section-2.9-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.9-2.3">ticket_endpoint</dt>
          <dd style="margin-left: 1.5em" id="section-2.9-2.4">If this endpoint is declared this indicates that the authorization
server explicitly implements the server-side of ticket deposit
flow. A client MAY use the "token_endpoint" as a fall-back target
as an implicit (and not guaranteed) signal and target endpoint.<a href="#section-2.9-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.9-2.5">grant_types_supported</dt>
          <dd style="margin-left: 1.5em" id="section-2.9-2.6">If the authorization server supports authorization code on-behalf-of
grant flow this MUST include
"urn:indieweb.org:params:oauth:grant-type:on_behalf_of"; if it
supports ticket grant flow it MUST include
"urn:indieweb.org:params:oauth:grant-type:ticket".<a href="#section-2.9-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ticket-introspection">
<section id="section-2.10">
        <h3 id="name-ticket-introspection">
<a href="#section-2.10" class="section-number selfRef">2.10. </a><a href="#name-ticket-introspection" class="section-name selfRef">Ticket Introspection</a>
        </h3>
<p id="section-2.10-1">If an authorization server implements OAuth Introspection
<span>[<a href="#RFC7662" class="xref">RFC7662</a>]</span> it MAY consider a ticket to be like a token and allow
it to be introspected with "token_type__hint=ticket" as per Section 1 of <span>[<a href="#RFC7662" class="xref">RFC7662</a>]</span>.<a href="#section-2.10-1" class="pilcrow">¶</a></p>
<p id="section-2.10-2">Example token introspection request against a ticket:<a href="#section-2.10-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-2.10-3">
<pre>POST /as/token_introspect HTTP/1.1
Host: https://bob.example.com
Content-type: application/x-www-form-urlencoded; charset=utf-8
Accept: application/json

token=TICKET1234
&amp;token_type_hint=ticket
</pre><a href="#section-2.10-3" class="pilcrow">¶</a>
</div>
<p id="section-2.10-4">Example token introspection response against a ticket:<a href="#section-2.10-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-2.10-5">
<pre>HTTP 1.1
Content-Type: application/json
Cache: no-cache, no-store

{
   "active" : false,
   "scope": "read",
   "client_id": "https://bob.example"
   "username": "rachel obo alice",
   "token_type": "ticket",
   "iat": "1648710000",
   "exp": "1648992070",
   "sub": "https://alice.example/",
   "aud": "https://bob.example/".
   "iss": "https://bob.example/as"
}
</pre><a href="#section-2.10-5" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ticket-wanted-flow">
<section id="section-3">
      <h2 id="name-ticket-wanted-flow">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-ticket-wanted-flow" class="section-name selfRef">Ticket Wanted Flow</a>
      </h2>
<span id="name-sequence-diagram-for-ticket"></span><figure id="figure-4">
        <div class="alignLeft art-ascii-art art-text artwork" id="section-3-1.1">
<pre>┌──────────────────────────────────────────────────────────────────────┐
│             ticket wanted flow - (subject, audience):nil             │
└──────────────────────────────────────────────────────────────────────┘
                               ┌───────────────────────────────┐
                               │           audience            │
                               ├───────────────────────────────┤
                               │     authorization server      │
┌───────────────┐              ├───────────────┬───────────────┤
│    client     │              │   /metadata   │/ticket_wanted │
└───────────────┘              └───────────────┴───────────────┘
        │                              │               │
       ┌┴┐                             │               │
       │ │read audience metadata       │               │
       │ │want ticket_wanted_endpoint  │               │
       │ │────────────────────────────▶│               │
       │ │send request:                │               │
       │ │send a ticket to "subject"   │               │
       │ │─────────────────────────────┼─────────────▶┌┴┐
       │ │successful response:         │              │ │
       │ │request received             │              │ │
       │ │◀─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┼ ─ ─ ─ ─ ─ ─ ─│ │
       └┬┘                             │              └┬┘
┌OPT─ ─ ┼ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─ ─ ─
        │                              │       ┌─REF───┴───────┐       │
│       │                              │       │ticket deposit │
        │                              │       └───────┬───────┘       │
└ ─ ─ ─ ┼ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─ ─ ─
        ▼                              ▼               ▼
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-sequence-diagram-for-ticket" class="selfRef">Sequence diagram for ticket wanted flow</a>
        </figcaption></figure>
<div id="disco-audience-as-metadata-1">
<section id="section-3.1">
        <h3 id="name-target-endpoint-discovery-2">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-target-endpoint-discovery-2" class="section-name selfRef">Target Endpoint Discovery</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-3.1-1">
<li id="section-3.1-1.1">Obtain the metadata for the authorization server for the subject as
detailed in <a href="#disco-audience-as-metadata" class="xref">Section 2.3.2</a>.<a href="#section-3.1-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-1.2">Target endpoint is the "ticket_wanted_endpoint" property in the
metadata; if the property does not exist or has an empty value
fallback to the "token_endpoint" property.<a href="#section-3.1-1.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.1-2">The target endpoint MUST use the "https" scheme per <a href="#security-considerations" class="xref">Section 7</a>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request">
<section id="section-3.2">
        <h3 id="name-request-2">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-request-2" class="section-name selfRef">Request</a>
        </h3>
<p id="section-3.2-1">The client makes a request as specified in <a href="#flow-request" class="xref">Section 2.4</a> to the
target endpoint with the following parameters:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.2-2">
          <dt id="section-3.2-2.1">action</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.2">REQUIRED. This MUST be "ticket". NOTE: if the ticket is received
on a "token_endpoint" this key-value combination can be used to
easily identify the request as one for ticket wanted.<a href="#section-3.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.2-2.3">subject</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-2.4">REQUIRED. The user profile URL of the subject.<a href="#section-3.2-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.2-3">Example ticket wanted request:<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-3.2-4">
<pre>POST /as/ticket_wanted HTTP/1.1
Host: https://bob.example.com
Content-type: application/x-www-form-urlencoded; charset=utf-8
Accept: application/json

action=ticket
&amp;subject=https://alice.example.com/
</pre><a href="#section-3.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="processing">
<section id="section-3.3">
        <h3 id="name-processing-2">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-processing-2" class="section-name selfRef">Processing</a>
        </h3>
<p id="section-3.3-1">The request is processed as specified in <a href="#flow-processing" class="xref">Section 2.5</a> and the
specific work to be performed for ticket wanted flow is:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3-2">
<li id="section-3.3-2.1">To decide to act on the wanted request or not.<a href="#section-3.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-2.2">If it decides to act it does Ticket Deposit Flow for the subject in
the request.<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="successful-response">
<section id="section-3.4">
        <h3 id="name-successful-response-2">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-successful-response-2" class="section-name selfRef">Successful Response</a>
        </h3>
<p id="section-3.4-1">The response will be as specified in <a href="#flow-successful-response" class="xref">Section 2.6</a> and
there are no response parameters so the body of the response is at
the discretion of the authorization server.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">It is RECOMMEND that http content negotiation as specified in section
5.3 of <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span> is undertaken and the server responds to following
media types accordingly (defaulting to "application/json"):<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.4-3">
          <dt id="section-3.4-3.1">application+json</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-3.2">An object with a single key of "subject" and value of the subject in
the request (which may be different due to normalization or
canonicalization).<a href="#section-3.4-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.4-4">Example ticket wanted response with content-negotiated JSON body:<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-3.4-5">
<pre>HTTP 1.1
Content-Type: application/json
Cache: no-cache, no-store

{
   "subject" : "https://alice.example.com/"
}
</pre><a href="#section-3.4-5" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-3.4-6">
          <dt id="section-3.4-6.1">text/plain:</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-6.2">"Ticket Wanted Request Received for <code>&lt;subject&gt;</code>"<a href="#section-3.4-6.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-3.4-7">Example ticket wanted response with content negotiated text/plain body:<a href="#section-3.4-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-3.4-8">
<pre>HTTP 1.1
Content-Type: text/plain
Cache: no-cache, no-store

Received Ticket Wanted Request for https://alice.example.com/
</pre><a href="#section-3.4-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-response">
<section id="section-3.5">
        <h3 id="name-error-response-2">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-error-response-2" class="section-name selfRef">Error Response</a>
        </h3>
<p id="section-3.5-1">If an error response is warranted it MUST be as per
<a href="#flow-error-response" class="xref">Section 2.7</a>.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">An error response MUST only be returned if there is a problem with the
request parameters per se (for example missing or malformed).<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">The server MUST NOT return an error response if the subject is not
known because that would leak that the publisher does not have a
relationship with the subject, and conversely that it does
(which would be an issue if the request did not originate from the
subject but from a malicious client).<a href="#section-3.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ticket-deposit-flow">
<section id="section-4">
      <h2 id="name-ticket-deposit-flow">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-ticket-deposit-flow" class="section-name selfRef">Ticket Deposit Flow</a>
      </h2>
<span id="name-sequence-diagram-for-ticket-"></span><figure id="figure-5">
        <div class="alignLeft art-ascii-art art-text artwork" id="section-4-1.1">
<pre>┌──────────────────────────────────────────────────────────────────────┐
│                 ticket deposit flow - f(subject):nil                 │
└──────────────────────────────────────────────────────────────────────┘
                               ┌───────────────────────────────┐
                               │            subject            │
                               ├───────────────────────────────┤
                               │              as               │
┌───────────────┐              ├───────────────┬───────────────┤
│    client     │              │   /metadata   │    /ticket    │
└───────────────┘              └───────────────┴───────────────┘
        │ read subject as metadata     │               │
        │ want ticket_endpoint         │               │
       ┌┴┐────────────────────────────▶│               │
       │ │generate ticket              │               │
       │ │send request:                │               │
       │ │ticket to use at "audience"  │               │
       │ │─────────────────────────────┼─────────────▶┌┴┐
       │ │successful response:         │              │ │
       │ │request received             │              │ │
       └┬┘◀─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┼ ─ ─ ─ ─ ─ ─ ─│ │
┌OPT─ ─ ┼ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─ ─ ┤ ├ ─ ─ ─ ─ ─ ─ ─
        │                              │       ┌─REF──┴─┴──────┐       │
│       │                              │       │ ticket grant  │
        │                              │       └───────┬───────┘       │
└ ─ ─ ─ ┼ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─ ─ ─│─ ─ ─ ─ ─ ─ ─ ─
        ▼                              ▼               ▼
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-sequence-diagram-for-ticket-" class="selfRef">Sequence diagram for ticket deposit flow</a>
        </figcaption></figure>
<div id="target-discovery">
<section id="section-4.1">
        <h3 id="name-target-discovery">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-target-discovery" class="section-name selfRef">Target Discovery</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-4.1-1">
<li id="section-4.1-1.1">Obtain the metadata for the authorization server for the subject as
detailed in <a href="#disco-subject-as-metadata" class="xref">Section 2.3.1</a>.<a href="#section-4.1-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.1-1.2">Target endpoint is the "ticket_endpoint" property in the
metadata.<a href="#section-4.1-1.2" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-4.1-2">The target endpoint MUST use the https schema per
<a href="#security-considerations" class="xref">Section 7</a>.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-1">
<section id="section-4.2">
        <h3 id="name-request-3">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-request-3" class="section-name selfRef">Request</a>
        </h3>
<p id="section-4.2-1">The client makes a request as specified in <a href="#flow-request" class="xref">Section 2.4</a> to the
target endpoint with the following parameters:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.2-2">
          <dt id="section-4.2-2.1">subject</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.2">REQUIRED. The user profile URL of the subject.<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-2.3">resource</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.4">REQUIRED. The URL to the resource server where the ticket can be
used (the audience). If the path component is just the root directory this is a hint that the ticket can be exchanged for an token (using ticket grant) otherwise it is a path to feed on the resource server that the subject may be interested in subscribing to in their feed reader.<a href="#section-4.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-2.5">ticket</dt>
          <dd style="margin-left: 1.5em" id="section-4.2-2.6">REQUIRED. The ticket as per <a href="#the-ticket" class="xref">Section 2.8</a>.<a href="#section-4.2-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-3">Example ticket deposit request:<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-4.2-4">
<pre>POST /as/ticket_wanted HTTP/1.1
Host: bob.example.com
Content-type: application/x-www-form-urlencoded; charset=utf-8
Accept: application/json, text/plain

subject=https://alice.example.com/
resource=https://bob.example.com/
ticket=TICKET1234567890
</pre><a href="#section-4.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.2-5">Example ticket deposit request hinting there is a feed that the
subject can subscribe to:<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-4.2-6">
<pre>POST /as/ticket_wanted HTTP/1.1
Host: bob.example.com
Content-type: application/x-www-form-urlencoded; charset=utf-8
Accept: application/json, text/plain

subject=https://alice.example.com/
resource=https://bob.example.com/feeds/
ticket=TICKET1234567890
</pre><a href="#section-4.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="processing-1">
<section id="section-4.3">
        <h3 id="name-processing-3">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-processing-3" class="section-name selfRef">Processing</a>
        </h3>
<p id="section-4.3-1">The request is processed as specified in <a href="#flow-processing" class="xref">Section 2.5</a> and the
specific work to be performed for ticket deposit flow is:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3-2">
<li id="section-4.3-2.1">Confirm that the subject is handled by this
authorization server.<a href="#section-4.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.2">If "resource" has a path component that is not just the root
directory, it is a path to a feed that can be subscribed to; how the
authorization server does this is outside the scope of this
specification but would typically involve a subscription
request as specified in Section 5.1 of <span>[<a href="#W3C.REC-websub-20180123" class="xref">W3C.REC-websub-20180123</a>]</span> to
an endpoint configured by the subject.<a href="#section-4.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-4.3-2.3">
            <p id="section-4.3-2.3.1">Optionally, perform ticket grant type flow with the following
parameters:<a href="#section-4.3-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.3-2.3.2.1">ticket is the "ticket" from the request.<a href="#section-4.3-2.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-4.3-2.3.2.2">audience is the "resource" from the request.<a href="#section-4.3-2.3.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ol>
</section>
</div>
<div id="successful-response-1">
<section id="section-4.4">
        <h3 id="name-successful-response-3">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-successful-response-3" class="section-name selfRef">Successful Response</a>
        </h3>
<p id="section-4.4-1">The authorization server MUST respond as specified in
<a href="#flow-successful-response" class="xref">Section 2.6</a> with the caveat that a response body is
optional, but if provided the parameters are:<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-4.4-2">
          <dt id="section-4.4-2.1">ticket_received</dt>
          <dd style="margin-left: 1.5em" id="section-4.4-2.2">The value of the ticket in the request.<a href="#section-4.4-2.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.4-3">Example ticket deposit successful response:<a href="#section-4.4-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-4.4-4">
<pre>HTTP/1.1 202 Accepted
Content-Type: application/json
Cache-Control: no-cache, no-store

{
  "ticket_deposited" : "TICKET1234567890"
}
</pre><a href="#section-4.4-4" class="pilcrow">¶</a>
</div>
<p id="section-4.4-5">A server MAY use content negotiation, and respond to "text/plain" with
the a body containing the parameter as a key "=" value.<a href="#section-4.4-5" class="pilcrow">¶</a></p>
<p id="section-4.4-6">Example ticket deposit successful response with
content-negotiated text/plain body:<a href="#section-4.4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-4.4-7">
<pre>HTTP/1.1 202 Accepted
Content-Type: text/plain
Cache-Control: no-cache, no-store

ticket_deposited=TICKET1234567890
</pre><a href="#section-4.4-7" class="pilcrow">¶</a>
</div>
<p id="section-4.4-8">For content negotiation evaluating to "text/html" the server can
respond with any body that it likes.<a href="#section-4.4-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="error-response-1">
<section id="section-4.5">
        <h3 id="name-error-response-3">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-error-response-3" class="section-name selfRef">Error Response</a>
        </h3>
<p id="section-4.5-1">If an error response is warranted it MUST be as per
<a href="#flow-error-response" class="xref">Section 2.7</a>.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ticket-grant-flow">
<section id="section-5">
      <h2 id="name-ticket-grant-flow">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-ticket-grant-flow" class="section-name selfRef">Ticket Grant Flow</a>
      </h2>
<span id="name-sequence-diagram-for-ticket-g"></span><figure id="figure-6">
        <div class="alignLeft art-ascii-art art-text artwork" id="section-5-1.1">
<pre>┌──────────────────────────────────────────────────────────────────────┐
│              ticket grant flow – f(ticket, audience):ac              │
└──────────────────────────────────────────────────────────────────────┘
                               ┌───────────────────────────────┐
                               │           audience            │
                               ├───────────────────────────────┤
                               │              as               │
┌───────────────┐              ├───────────────┬───────────────┤
│    client     │              │   /metadata   │    /ticket    │
└───────────────┘              └───────────────┴───────────────┘
        │ read audience as metadata    │               │
        │ want token                   │               │
       ┌┴┐────────────────────────────▶│               │
       │ │                             │               │
       │ │send request:                │               │
       │ │grant ac for this ticket     │               │
       │ │─────────────────────────────┼─────────────▶┌┴┐
       │ │successful response:         │              │ │
       │ │ac (Bearer token)            │              │ │
       └┬┘◀─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┼ ─ ─ ─ ─ ─ ─ ─└┬┘
        │                              │               │
        ▼                              ▼               ▼
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-sequence-diagram-for-ticket-g" class="selfRef">Sequence diagram for ticket grant flow</a>
        </figcaption></figure>
<div id="discovery">
<section id="section-5.1">
        <h3 id="name-discovery">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-discovery" class="section-name selfRef">Discovery</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-5.1-1">
<li id="section-5.1-1.1">Obtain the metadata for the authorization server for the audience
as detailed in <a href="#disco-audience-as-metadata" class="xref">Section 2.3.2</a>.<a href="#section-5.1-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.1-1.2">The target endpoint is the "token_endpoint" property.<a href="#section-5.1-1.2" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="request-2">
<section id="section-5.2">
        <h3 id="name-request-4">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-request-4" class="section-name selfRef">Request</a>
        </h3>
<p id="section-5.2-1">The client makes a request as specified in <a href="#flow-request" class="xref">Section 2.4</a> to the
target endpoint with the following parameters:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.2-2">
          <dt id="section-5.2-2.1">grant_type</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.2">REQUIRED. This MUST be "ticket".<a href="#section-5.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-5.2-2.3">ticket</dt>
          <dd style="margin-left: 1.5em" id="section-5.2-2.4">REQUIRED the ticket to exchange for an access code (Bearer token).<a href="#section-5.2-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-5.2-3">Example ticket grant request:<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-5.2-4">
<pre>POST /as/token HTTP/1.1
Host: bob.example.com
Content-type: application/x-www-form-urlencoded; charset=utf-8
Accept: application/json, text/plain

grant_type=ticket
&amp;ticket=TICKET1234567890
</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="processing-2">
<section id="section-5.3">
        <h3 id="name-processing-4">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-processing-4" class="section-name selfRef">Processing</a>
        </h3>
<p id="section-5.3-1">The request is processed as specified in <a href="#flow-processing" class="xref">Section 2.5</a> and the
specific work to be performed for ticket grant flow is:<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3-2">
<li id="section-5.3-2.1">The generation of a Bearer token for the subject with a short
lifespan due to <a href="#security-considerations" class="xref">Section 7</a>. It is RECOMMENDED that
the age be limited to more than 36 hours.<a href="#section-5.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.3-2.2">
            <p id="section-5.3-2.2.1">Construction of access token response<a href="#section-5.3-2.2.1" class="pilcrow">¶</a></p>
<p id="section-5.3-2.2.2">
Note that a refresh token SHOULD NOT be included in the response
but if it is it will be ignored.<a href="#section-5.3-2.2.2" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="successful-response-2">
<section id="section-5.4">
        <h3 id="name-successful-response-4">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-successful-response-4" class="section-name selfRef">Successful Response</a>
        </h3>
<p id="section-5.4-1">The response is an access token response as specified in section 5.3.3
of <span>[<a href="#IndieAuth" class="xref">IndieAuth</a>]</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">Example response to a ticket grant request:<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-5.4-3">
<pre>HTTP 1.1
Content-Type: application/json
Cache: no-cache, no-store

{
  "access_token" : "TOKEN1234567890",
  "token_type"   : "Bearer",
  "expires_in"   : 259200,
  "scope"        : "read"
}
</pre><a href="#section-5.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-response-2">
<section id="section-5.5">
        <h3 id="name-error-response-4">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-error-response-4" class="section-name selfRef">Error Response</a>
        </h3>
<p id="section-5.5-1">If an error response is warranted it MUST be as per
<a href="#flow-error-response" class="xref">Section 2.7</a>.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="code-obo-flow">
<section id="section-6">
      <h2 id="name-authorization-code-on-behal">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-authorization-code-on-behal" class="section-name selfRef">Authorization Code On-Behalf-Of Grant Flow</a>
      </h2>
<span id="name-sequence-diagram-for-author"></span><figure id="figure-7">
        <div class="alignLeft art-ascii-art art-text artwork" id="section-6-1.1">
<pre>┌──────────────────────────────────────────────────────────────────────┐
│   ac-obo flow – f(subject, resource/audience, actor/client_id):ac    │
└──────────────────────────────────────────────────────────────────────┘
                               ┌───────────────────────────────┐
                               │            subject            │
                               ├───────────────────────────────┤
                               │              as               │
┌───────────────┐              ├───────────────┬───────────────┤
│    client     │              │   /metadata   │    /token     │
└───────────────┘              └───────────────┴───────────────┘
        │                              │               │
        │ read subject as metadata     │               │
        │ want token endpoint          │               │
       ┌┴┐────────────────────────────▶│               │
       │ │send request:                │               │
       │ │grant ac for actor           │               │
       │ │to use at audience           │               │
       │ │on behalf of subject         │               │
       │ │─────────────────────────────┼─────────────▶┌┴┐
       │ │                             │       ┌─REF──┴─┴──────┐
       │ │                             │       │ ticket wanted │
       │ │                             │       └──────┬─┬──────┘
       │ │                             │       ┌─REF──┴─┴──────┐
       │ │                             │       │ticket deposit │
       │ │                             │       └──────┬─┬──────┘
       │ │                             │       ┌─REF──┴─┴──────┐
       │ │ successful response:        │       │ ticket grant  │
       │ │ ac (Bearer token)           │       └──────┬─┬──────┘
       └┬┘◀─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ┼ ─ ─ ─ ─ ─ ─ ─└┬┘
        │                              │               │
        ▼                              ▼               ▼
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-sequence-diagram-for-author" class="selfRef">Sequence diagram for authorization code on-behalf-of grant flow</a>
        </figcaption></figure>
<div id="discovery-1">
<section id="section-6.1">
        <h3 id="name-discovery-2">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-discovery-2" class="section-name selfRef">Discovery</a>
        </h3>
<ol start="1" type="1" class="normal type-1" id="section-6.1-1">
<li id="section-6.1-1.1">Obtain the metadata for the authorization server for the subject
as detailed in <a href="#disco-subject-as-metadata" class="xref">Section 2.3.1</a>.<a href="#section-6.1-1.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-1.2">The metadata MUST have a "grant_types_supported" that
includes "on_behalf_of" to indicate that the subject's authorization
server supports "requested_token_use=on_behalf_of" at
its "token_endpoint" and is therefore a signal that it implements the
authorization code on behalf of grant flow.<a href="#section-6.1-1.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.1-1.3">The target endpoint is the "ticket_endpoint" property in the
metadata.<a href="#section-6.1-1.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="request-3">
<section id="section-6.2">
        <h3 id="name-request-5">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-request-5" class="section-name selfRef">Request</a>
        </h3>
<p id="section-6.2-1">When the request is made, it MUST also include something which can be
used to assure the receiver that it has come from the
"client_id" provided. The client MUST NOT use more than one method in
 each request. The following methods be offered:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2-2">
          <dt id="section-6.2-2.1">client_secret</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-2.2">By providing a "client_secret" that has previously been exchange
out-of-band between the actor and the subject.<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-2.3">clientid, claimtype="code_verifier" and claim</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-2.4">By providing the last successful "code_verifier" parameter from when
the client assured their identity with the actor. This is the
preferred method because it provides a "hands-off" experience for the
subject. The rationale for using a PKCE Code Verifier is detailed in
<a href="#why-code-verifier" class="xref">Appendix A</a>.<a href="#section-6.2-2.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-3">The client makes a request as specified in <a href="#flow-request" class="xref">Section 2.4</a> to the
target endpoint with the following parameters:<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2-4">
          <dt id="section-6.2-4.1">grant_type</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.2">REQUIRED. This MUST be "authorization_code".<a href="#section-6.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.3">requested_token_use</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.4">REQUIRED. This MUST
be "urn:indieweb.org:params:oauth:grant-type:on_behalf_of" or the
less strictly qualified form "on_behalf_of".<a href="#section-6.2-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.5">subject</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.6">REQUIRED. The user profile URL of the subject.<a href="#section-6.2-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.7">resource</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.8">REQUIRED. The URL of the resource server where the granted code
will be used, i.e. the audience.<a href="#section-6.2-4.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.9">client_id</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.10">REQUIRED. The URL of the requestor (the actor).<a href="#section-6.2-4.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.11">client_secret</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.12">OPTIONAL. A secret previously provided by the actor to assure
the receiver that the request was made by it.<a href="#section-6.2-4.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.13">claim</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.14">OPTIONAL but REQUIRED if "claim_type" is not provided. An
item from the actor's authorization server to prove its claim to
be the aforementioned to the caller. This parameter
becomes <strong>MANDATORY</strong> when no "client_secret" is offered.<a href="#section-6.2-4.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-4.15">claim_type</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-4.16">OPTIONAL but REQUIRED if "claim" is provided. The format of
the proof as defined by the authorization server. The value
indicates what type of data the "claim" parameters contains.<a href="#section-6.2-4.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-5">Example authorization code on-behalf-of grant request:<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-6.2-6">
<pre>POST /as/token HTTP/1.1
Host: alice.example.com
Content-type: application/x-www-form-urlencoded; charset=utf-8
Accept: application/json

grant_type=authorization_code
&amp;requested_token_use=on_behalf_of
&amp;subject=https://alice.example.com/
&amp;resource=https://bob.example.com/
&amp;client_id=https://rachel.example.com/
&amp;claim=CV123
&amp;claim_type=pkce_verifier
</pre><a href="#section-6.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="processing-3">
<section id="section-6.3">
        <h3 id="name-processing-5">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-processing-5" class="section-name selfRef">Processing</a>
        </h3>
<p id="section-6.3-1">The request is processed as specified in <a href="#flow-processing" class="xref">Section 2.5</a> and the
specific work to be performed for authorization code on-behalf-of
grant flow is:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3-2">
<li id="section-6.3-2.1">Check that the subject is known to the token endpoint.<a href="#section-6.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.2">Check that the client_id corresponds to an actor
(reader) that it wants to delegate to.<a href="#section-6.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.3">Ensure that the subject has verified their identity with the
client (the actor); if the subject has verified their identity, the
authorization server should have a record of the code request made to
its authorization endpoint.<a href="#section-6.3-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.4">Check that the client issuing the grant request is who they claim
to be. This is done by checking the validity of the "claim"
and "claim_type" pairing.<a href="#section-6.3-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.5">Do ticket wanted flow (target is the current authorization
server) to request a ticket.<a href="#section-6.3-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.6">Wait for a ticket to be made available via ticket deposit flow.<a href="#section-6.3-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.7">Do ticket grant flow (with target of subject) to exchange the
ticket for a token.<a href="#section-6.3-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.8">Ensure that the ticket grant response meets the constrictions
specified in <a href="#obo-successful-response" class="xref">Section 6.4</a> and if not it a policy
decision whether to respond with an error response or to filter the
parameters to conform.<a href="#section-6.3-2.8" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.9">The response parameters are the ticket grant response parameters
with the caveat that the "refresh_token" if provided MUST be
removed.<a href="#section-6.3-2.9" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="obo-successful-response">
<section id="section-6.4">
        <h3 id="name-successful-response-5">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-successful-response-5" class="section-name selfRef">Successful Response</a>
        </h3>
<p id="section-6.4-1">If a successful response is warranted it MUST be as per
<a href="#flow-successful-response" class="xref">Section 2.6</a> and the parameters correspond to this for
a normal OAuth 2.0 response as specified in Section 5 of
<span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> but the following constraints:<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1">It is RECOMMENDED the expiration time is in the near future and that
a refresh token is provided.<a href="#section-6.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-2.2">The "scope" MUST contain at least "read".<a href="#section-6.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-2.3">The "scope" SHOULD be as limited as possible as per
<a href="#security-considerations" class="xref">Section 7</a>.<a href="#section-6.4-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.4-3">Additional parameters MAY be included for implementation-specific
reasons.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">Example access token successful response:<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-http art-text artwork" id="section-6.4-5">
<pre>HTTP 1.1 200 OK
Content-type: application/json
Cache-Control: no-cache, no-store

{
  "access_token" : "AT1234"
  "token_type"   : "Bearer"
  "expires_in"   : 3600
  "scope"        : "read"
  "refresh_token": "RT1234"
}
</pre><a href="#section-6.4-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="error-response-3">
<section id="section-6.5">
        <h3 id="name-error-response-5">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-error-response-5" class="section-name selfRef">Error Response</a>
        </h3>
<p id="section-6.5-1">If an error response is warranted it MUST be as per
<a href="#flow-error-response" class="xref">Section 2.7</a>.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">The following alternative "error" values MUST be used instead of the
generic "bad_request" in the following circumstances:<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.5-3">
          <dt id="section-6.5-3.1">"invalid_ticket_want"</dt>
          <dd style="margin-left: 1.5em" id="section-6.5-3.2">When there is an issue performing the ticket wanted flow (W) with
the "audience", for example, unable to obtain the metadata for the
authorization server. It is HIGHLY RECOMMENDED that the reason is
returned in the "error_description" with attention to
<a href="#security-considerations" class="xref">Section 7</a> and <a href="#privacy-considerations" class="xref">Section 8</a>.<a href="#section-6.5-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.5-3.3">"invalid_ticket"</dt>
          <dd style="margin-left: 1.5em" id="section-6.5-3.4">When either no ticket is available or one has not been received in
response to a ticket wanted request, within a reasonable amount of
time.<a href="#section-6.5-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.5-3.5">"invalid_ticket_grant"</dt>
          <dd style="margin-left: 1.5em" id="section-6.5-3.6">When there is an issue performing the ticket grant flow (X) with the
audience's authorization server. It is HIGHLY RECOMMENDED that the
reason is returned in the "error_description" with attention to
<a href="#security-considerations" class="xref">Section 7</a> and <a href="#privacy-considerations" class="xref">Section 8</a>.<a href="#section-6.5-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">Much of the guidance from Section 10 of <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>, the Security
Considerations in The OAuth 2.0 Authorization Framework, is also
applicable here. Furthermore, <span>[<a href="#RFC6819" class="xref">RFC6819</a>]</span> provides additional security
considerations for OAuth, and <span>[<a href="#I-D.ietf-oauth-security-topics" class="xref">I-D.ietf-oauth-security-topics</a>]</span> has
updated security guidance based on deployment experience and new
threats that have emerged since OAuth 2.0 was originally published.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">If the ticket issued by an authorization server is a JWT particular
attention should be paid to Section 5 of <span>[<a href="#RFC9068" class="xref">RFC9068</a>]</span>.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The use of JWTs as a ticket is not encouraged and implementors should
use an opaque string.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">Do NOT attempt to read tickets. No assumption should be made as to their
format and they may or many not validate as a JWT. While reading
tickets is a useful for debugging, implementations should not depend on
this ability because tickets are opaque.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">In addition, both delegation and impersonation introduce unique security
issues. Any time one principal is delegated the rights of another
principal, the potential for abuse is a concern. The use of the "scope"
claim (in addition to other typical constraints such as a limited token
lifetime) is suggested to mitigate potential for such abuse, as it
restricts the contexts in which the delegated rights can be exercised.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">For authorization code on-behalf-of grant flow, the relative agency of
the subject is limited by the expiration time of the token issued.
The agency can only be exercised when the subject's authorization
server is requested to acquire a new token during this flow. Hence
the limitation on the subject's agency is bounded by the age of the
token from the audience that they forward to the actor. For this
reason it is imperative that an audience issue tokens in response to
this grant request with a sensibly short expiration time to ensure
the subject can maintain agency over the actor.<a href="#section-7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-8">
      <h2 id="name-privacy-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-8-1">Tickets and tokens employed in the context of the functionality
described herein may contain privacy-sensitive information and, to
prevent disclosure of such information to unintended parties, MUST only
be transmitted over encrypted channels, such as Transport Layer
Security (TLS).<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Deployments SHOULD determine the minimally necessary amount of data and
only include such information in issued tickets or tokens. In some
cases, data minimization may be needed and this is of particular
relevance when an authorization server is acting like an STS in
authorization code on-behalf-of grant flow.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="indieweb-considerations">
<section id="section-9">
      <h2 id="name-indieweb-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-indieweb-considerations" class="section-name selfRef">IndieWeb Considerations</a>
      </h2>
<ol start="1" type="1" class="normal type-1" id="section-9-1">
<li id="section-9-1.1">In <span>[<a href="#IndieAuth" class="xref">IndieAuth</a>]</span> the user profile URL can use the http or https
scheme. The use of https is contrary to <a href="#security-considerations" class="xref">Section 7</a>.<a href="#section-9-1.1" class="pilcrow">¶</a>
</li>
        <li id="section-9-1.2">Some authorization servers may regard user profiles URLs at the
same host and path but access by different scheme
(<a href="http://example.com/">http://example.com/</a> and <a href="https://example.com/">https://example.com/</a>) as separate
identities. As IndieWeb uses the domain as a identifier for a
subject, this would seem to be misinterpretation. Give the previous
consideration if user profiles were mandated to be accessible only
over https then this second consideration would be moot.<a href="#section-9-1.2" class="pilcrow">¶</a>
</li>
      </ol>
<div id="oauth-parameters-registry">
<section id="section-9.1">
        <h3 id="name-oauth-parameters-registry">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">"OAuth Parameters" Registry</a>
        </h3>
<p id="section-9.1-1">To indicate ticket grant flow is supported:<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-2.1">URN: <code>urn:indieweb.org:params:oauth:grant-type:ticket</code><a href="#section-9.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.1-2.2">Common Name: Ticket exchange grant type for IndieAuth Ticketing<a href="#section-9.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.1-2.3">Change Controller: indieweb.org<a href="#section-9.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.1-2.4">Specification Document: <a href="#as-metadata" class="xref">Section 2.9</a> of this specification<a href="#section-9.1-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-9.1-3">To signal that authorization code on-behalf-of grant flow is supported:<a href="#section-9.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-4.1">URN: <code>urn:indieweb.org:params:oauth:grant-type:on_behalf_of</code><a href="#section-9.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.1-4.2">Common Name: On-Behalf-Of Ticketing grant type<a href="#section-9.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.1-4.3">Change Controller: indieweb.org<a href="#section-9.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-9.1-4.4">Specification Document: <a href="#as-metadata" class="xref">Section 2.9</a> of this specification<a href="#section-9.1-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">There are no IANA actions requested at this time.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="related-work">
<section id="section-11">
      <h2 id="name-related-work">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-related-work" class="section-name selfRef">Related Work</a>
      </h2>
<span class="break"></span><dl class="dlNewline" id="section-11-1">
        <dt id="section-11-1.1">Authorization Grants</dt>
        <dd style="margin-left: 1.5em" id="section-11-1.2">
          <span>[<a href="#RFC7521" class="xref">RFC7521</a>]</span> provides a common framework for OAuth 2.0 to interwork
with other identity systems using assertions and to provide
alternative client authentication mechanisms.<a href="#section-11-1.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-11-1.3">Assertion grant profile for OAuth 2.0 authorization grants</dt>
        <dd style="margin-left: 1.5em" id="section-11-1.4">
          <a href="https://docs.pingidentity.com/bundle/pingfederate-93/page/umd1564002958895.html">https://docs.pingidentity.com/bundle/pingfederate-93/page/umd1564002958895.html</a><a href="#section-11-1.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-11-1.5">AutoAuth</dt>
        <dd style="margin-left: 1.5em" id="section-11-1.6">Described in <span>[<a href="#AutoAuth" class="xref">AutoAuth</a>]</span>. An extension to IndieAuth that allows
clients to authorize to other servers in the name of their user,
without the user being present to confirm each individual
authorization flow.<a href="#section-11-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-11-1.7">Microsoft identity platform and OAuth 2.0 On-Behalf-Of flow</dt>
        <dd style="margin-left: 1.5em" id="section-11-1.8">
          <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow">https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-on-behalf-of-flow</a><a href="#section-11-1.8" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-11-2">This where an application invokes a service/web API, which in turn
  needs to call another service/web API. The idea is to propagate the
  delegated user identity and permissions through the request chain.
  Detailed at<a href="#section-11-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11-3">
        <dt id="section-11-3.1">TicketAuth</dt>
        <dd style="margin-left: 1.5em" id="section-11-3.2">Described in <span>[<a href="#TicketAuth" class="xref">TicketAuth</a>]</span>, this is an extension to IndieAuth that
enables a publisher to send authorization, known as a ticket, that
can be redeemed for an access token. This allows both solicited and
unsolicited invitations to fetch restricted resources.<a href="#section-11-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-11-3.3">Token Exchange</dt>
        <dd style="margin-left: 1.5em" id="section-11-3.4">OAuth Token Exchange <span>[<a href="#RFC8693" class="xref">RFC8693</a>]</span> is a protocol to request and obtain
security tokens from an authorization server for impersonation and
delegation.<a href="#section-11-3.4" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<section id="section-12">
      <h2 id="name-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-12.1">
        <h3 id="name-normative-references">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-oauth-security-topics">[I-D.ietf-oauth-security-topics]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T.</span>, <span class="refAuthor">Bradley, J.</span>, <span class="refAuthor">Labunets, A.</span>, and <span class="refAuthor">D. Fett</span>, <span class="refTitle">"OAuth 2.0 Security Best Current Practice"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-security-topics-19</span>, <time datetime="2021-12-16" class="refDate">16 December 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-oauth-security-topics-19.txt">https://www.ietf.org/archive/id/draft-ietf-oauth-security-topics-19.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IndieAuth">[IndieAuth]</dt>
        <dd>
<span class="refAuthor">Parecki, A.</span>, <span class="refTitle">"IndieAuth, IndieWeb Living Standard"</span>, <time datetime="2022-02-12" class="refDate">12 February 2022</time>, <span>&lt;<a href="https://indieauth.spec.indieweb.org/">https://indieauth.spec.indieweb.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4122">[RFC4122]</dt>
        <dd>
<span class="refAuthor">Leach, P.</span>, <span class="refAuthor">Mealling, M.</span>, and <span class="refAuthor">R. Salz</span>, <span class="refTitle">"A Universally Unique IDentifier (UUID) URN Namespace"</span>, <span class="seriesInfo">RFC 4122</span>, <span class="seriesInfo">DOI 10.17487/RFC4122</span>, <time datetime="2005-07" class="refDate">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4122">https://www.rfc-editor.org/info/rfc4122</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6750">[RFC6750]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span> and <span class="refAuthor">D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6819">[RFC6819]</dt>
        <dd>
<span class="refAuthor">Lodderstedt, T., Ed.</span>, <span class="refAuthor">McGloin, M.</span>, and <span class="refAuthor">P. Hunt</span>, <span class="refTitle">"OAuth 2.0 Threat Model and Security Considerations"</span>, <span class="seriesInfo">RFC 6819</span>, <span class="seriesInfo">DOI 10.17487/RFC6819</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6819">https://www.rfc-editor.org/info/rfc6819</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7231">[RFC7231]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7636">[RFC7636]</dt>
        <dd>
<span class="refAuthor">Sakimura, N., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Agarwal</span>, <span class="refTitle">"Proof Key for Code Exchange by OAuth Public Clients"</span>, <span class="seriesInfo">RFC 7636</span>, <span class="seriesInfo">DOI 10.17487/RFC7636</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7636">https://www.rfc-editor.org/info/rfc7636</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7662">[RFC7662]</dt>
        <dd>
<span class="refAuthor">Richer, J., Ed.</span>, <span class="refTitle">"OAuth 2.0 Token Introspection"</span>, <span class="seriesInfo">RFC 7662</span>, <span class="seriesInfo">DOI 10.17487/RFC7662</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7662">https://www.rfc-editor.org/info/rfc7662</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8414">[RFC8414]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Sakimura, N.</span>, and <span class="refAuthor">J. Bradley</span>, <span class="refTitle">"OAuth 2.0 Authorization Server Metadata"</span>, <span class="seriesInfo">RFC 8414</span>, <span class="seriesInfo">DOI 10.17487/RFC8414</span>, <time datetime="2018-06" class="refDate">June 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8414">https://www.rfc-editor.org/info/rfc8414</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8693">[RFC8693]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Nadalin, A.</span>, <span class="refAuthor">Campbell, B., Ed.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">C. Mortimore</span>, <span class="refTitle">"OAuth 2.0 Token Exchange"</span>, <span class="seriesInfo">RFC 8693</span>, <span class="seriesInfo">DOI 10.17487/RFC8693</span>, <time datetime="2020-01" class="refDate">January 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8693">https://www.rfc-editor.org/info/rfc8693</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9068">[RFC9068]</dt>
      <dd>
<span class="refAuthor">Bertocci, V.</span>, <span class="refTitle">"JSON Web Token (JWT) Profile for OAuth 2.0 Access Tokens"</span>, <span class="seriesInfo">RFC 9068</span>, <span class="seriesInfo">DOI 10.17487/RFC9068</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9068">https://www.rfc-editor.org/info/rfc9068</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12.2">
        <h3 id="name-informative-references">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="AutoAuth">[AutoAuth]</dt>
        <dd>
<span class="refAuthor">indieweb.org</span>, <span class="refTitle">"AutoAuth"</span>, <span>&lt;<a href="https://indieweb.org/AutoAuth">https://indieweb.org/AutoAuth</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7521">[RFC7521]</dt>
        <dd>
<span class="refAuthor">Campbell, B.</span>, <span class="refAuthor">Mortimore, C.</span>, <span class="refAuthor">Jones, M.</span>, and <span class="refAuthor">Y. Goland</span>, <span class="refTitle">"Assertion Framework for OAuth 2.0 Client Authentication and Authorization Grants"</span>, <span class="seriesInfo">RFC 7521</span>, <span class="seriesInfo">DOI 10.17487/RFC7521</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7521">https://www.rfc-editor.org/info/rfc7521</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TicketAuth">[TicketAuth]</dt>
        <dd>
<span class="refAuthor">indieweb.org</span>, <span class="refTitle">"IndieAuth Ticket Auth"</span>, <span>&lt;<a href="https://indieweb.org/IndieAuth_Ticket_Auth">https://indieweb.org/IndieAuth_Ticket_Auth</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C.REC-websub-20180123">[W3C.REC-websub-20180123]</dt>
      <dd>
<span class="refAuthor">Genestoux, J.</span> and <span class="refAuthor">A. Parecki</span>, <span class="refTitle">"WebSub"</span>, <span class="seriesInfo">World Wide Web Consortium Recommendation REC-websub-20180123</span>, <time datetime="2018-01-23" class="refDate">23 January 2018</time>, <span>&lt;<a href="https://www.w3.org/TR/2018/REC-websub-20180123">https://www.w3.org/TR/2018/REC-websub-20180123</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="why-code-verifier">
<section id="appendix-A">
      <h2 id="name-why-use-a-code-verifier">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-why-use-a-code-verifier" class="section-name selfRef">Why use a Code Verifier?</a>
      </h2>
<p id="appendix-A-1">If the subject has identified themselves to the actor as specified in
Section 5.3.2 of <span>[<a href="#IndieAuth" class="xref">IndieAuth</a>]</span> various exchanges will have taken
place between the subject's authorization server and the actor's
authorization client during which a "code_verifier" is generated
because IndieAuth mandates the use of PKCE as specified in
<span>[<a href="#RFC7636" class="xref">RFC7636</a>]</span>. The actor can use the "code_verifier" of the last
successfully exchange with the subject's authorization server as claim
that they are who they are on the basis that only they have this
information and that the subject's authorization server can verify
it. For this to be implemented:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">The actor MUST require the subject to identify themslves using
IndieAuth which means the actor has an authorization server.<a href="#appendix-A-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">The actor's authorization server MUST be able to stored and retrieve
the last successfully exchanged "code_verifier"  with the subject.<a href="#appendix-A-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.3">The subject's authorization server MUST be able to store and
retrieve the last successfully exchanged "code_verifier" with
the actor.<a href="#appendix-A-2.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">This document stands on the shoulders of the members of the IndieWeb
community for their work on <span>[<a href="#TicketAuth" class="xref">TicketAuth</a>]</span> and <span>[<a href="#AutoAuth" class="xref">AutoAuth</a>]</span> which
provided inspiration for this document.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The following individuals directly or indirectly contributed ideas,
feedback, and wording to this specification: @fluffy, @gwg, @zegnat.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-history">
<section id="appendix-C">
      <h2 id="name-document-history">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<div class="alignLeft art-text artwork" id="appendix-C-1">
<pre>[[ To be removed from the final specification ]]

-00

* first draft
</pre><a href="#appendix-C-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Somers</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dsomers@omz13.com" class="email">dsomers@omz13.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
